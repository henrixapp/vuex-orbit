import { Schema } from '@orbit/data';
import VuexStore from './vuex-store';
import { createLocalVue } from '@vue/test-utils';
import Vuex from "vuex";
import { clone } from '@orbit/utils';
var localVue = createLocalVue();
localVue.use(Vuex);
// @ts-ignore
var schemaDefinition = {
    models: {
        pet: {
            attributes: {
                name: {
                    type: "string"
                }
            }
        },
        species: {
            attributes: {
                name: {
                    type: "string"
                }
            }
        }
    }
};
var schema = new Schema(schemaDefinition);
var vStore = new VuexStore({ schema: schema });
var store = new Vuex.Store({
    modules: {
        vStore: vStore
    },
    strict: true,
    plugins: []
});
describe("simple example", function () {
    beforeEach(function () {
        vStore = new VuexStore({ schema: schema });
        store = new Vuex.Store({
            modules: {
                vStore: vStore
            },
            strict: true,
            plugins: []
        });
    });
    test("models present", function () {
        expect(store.getters.getField('petCollection')).toMatchObject([]);
        expect(store.getters.getField('pet')).toBeNull();
        expect(store.getters.getField('speciesCollection')).toMatchObject([]);
        expect(store.getters.getField('species')).toBeNull();
    });
    test("adding works", function (done) {
        store.dispatch('create', {
            type: 'pet',
            attributes: {
                name: 'Garfield'
            }
        }).then(function () {
            expect(store.getters.getField('petCollection').length).toBe(1);
            expect(store.getters.getField('pet.attributes.name')).toBe("Garfield");
            done();
        });
    });
    test("updating works", async function (done) {
        await store.dispatch('create', {
            type: 'pet',
            attributes: {
                name: 'Garfield'
            }
        });
        var garfield = clone(store.getters.getField('pet'));
        garfield.attributes.name = "Lassie";
        await store.dispatch('update', garfield);
        expect(store.getters.getField('petCollection').length).toBe(1);
        expect(store.getters.getField('pet.attributes.name')).toBe("Lassie");
        done();
    });
    test("deleting works", async function (done) {
        await store.dispatch('create', {
            type: 'pet',
            attributes: {
                name: 'Garfield'
            }
        });
        var garfield = clone(store.getters.getField('pet'));
        await store.dispatch('delete', garfield);
        expect(store.getters.getField('petCollection').length).toBe(0);
        expect(store.getters.getField('pet')).toBeNull();
        done();
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZ1ZXgtc3RvcmUudGVzdC5qcyJdLCJuYW1lcyI6WyJTY2hlbWEiLCJWdWV4U3RvcmUiLCJjcmVhdGVMb2NhbFZ1ZSIsIlZ1ZXgiLCJjbG9uZSIsImxvY2FsVnVlIiwidXNlIiwic2NoZW1hRGVmaW5pdGlvbiIsIm1vZGVscyIsInBldCIsImF0dHJpYnV0ZXMiLCJuYW1lIiwidHlwZSIsInNwZWNpZXMiLCJzY2hlbWEiLCJ2U3RvcmUiLCJzdG9yZSIsIlN0b3JlIiwibW9kdWxlcyIsInN0cmljdCIsInBsdWdpbnMiLCJkZXNjcmliZSIsImJlZm9yZUVhY2giLCJ0ZXN0IiwiZXhwZWN0IiwiZ2V0dGVycyIsImdldEZpZWxkIiwidG9NYXRjaE9iamVjdCIsInRvQmVOdWxsIiwiZGlzcGF0Y2giLCJ0aGVuIiwibGVuZ3RoIiwidG9CZSIsImRvbmUiLCJnYXJmaWVsZCJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsTUFBVCxRQUF1QixhQUF2QjtBQUNBLE9BQU9DLFNBQVAsTUFBc0IsY0FBdEI7QUFDQSxTQUFTQyxjQUFULFFBQStCLGlCQUEvQjtBQUNBLE9BQU9DLElBQVAsTUFBaUIsTUFBakI7QUFDQSxTQUFTQyxLQUFULFFBQXNCLGNBQXRCO0FBQ0EsSUFBTUMsV0FBV0gsZ0JBQWpCO0FBQ0FHLFNBQVNDLEdBQVQsQ0FBYUgsSUFBYjtBQUNBO0FBQ0EsSUFBTUksbUJBQW1CO0FBQ3JCQyxZQUFRO0FBQ0pDLGFBQUs7QUFDREMsd0JBQVk7QUFDUkMsc0JBQU07QUFDRkMsMEJBQU07QUFESjtBQURFO0FBRFgsU0FERDtBQVFKQyxpQkFBUztBQUNMSCx3QkFBWTtBQUNSQyxzQkFBTTtBQUNGQywwQkFBTTtBQURKO0FBREU7QUFEUDtBQVJMO0FBRGEsQ0FBekI7QUFrQkEsSUFBTUUsU0FBUyxJQUFJZCxNQUFKLENBQVdPLGdCQUFYLENBQWY7QUFDQSxJQUFJUSxTQUFTLElBQUlkLFNBQUosQ0FBYyxFQUFFYSxjQUFGLEVBQWQsQ0FBYjtBQUNBLElBQUlFLFFBQVEs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LGVBQU9SLE1BQU1TLE9BQU4sQ0FBY0MsUUFBZCxDQUF1QixLQUF2QixDQUFQLEVBQXNDRSxRQUF0QztBQUNBSztBQUNILEtBWkQ7QUFhSCxDQXhERCIsImZpbGUiOiJ2dWV4LXN0b3JlLnRlc3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTY2hlbWEgfSBmcm9tICdAb3JiaXQvZGF0YSc7XG5pbXBvcnQgVnVleFN0b3JlIGZyb20gJy4vdnVleC1zdG9yZSc7XG5pbXBvcnQgeyBjcmVhdGVMb2NhbFZ1ZSB9IGZyb20gJ0B2dWUvdGVzdC11dGlscyc7XG5pbXBvcnQgVnVleCBmcm9tIFwidnVleFwiO1xuaW1wb3J0IHsgY2xvbmUgfSBmcm9tICdAb3JiaXQvdXRpbHMnO1xuY29uc3QgbG9jYWxWdWUgPSBjcmVhdGVMb2NhbFZ1ZSgpO1xubG9jYWxWdWUudXNlKFZ1ZXgpO1xuLy8gQHRzLWlnbm9yZVxuY29uc3Qgc2NoZW1hRGVmaW5pdGlvbiA9IHtcbiAgICBtb2RlbHM6IHtcbiAgICAgICAgcGV0OiB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzcGVjaWVzOiB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufTtcbmNvbnN0IHNjaGVtYSA9IG5ldyBTY2hlbWEoc2NoZW1hRGVmaW5pdGlvbik7XG5sZXQgdlN0b3JlID0gbmV3IFZ1ZXhTdG9yZSh7IHNjaGVtYSB9KTtcbmxldCBzdG9yZSA9IG5ldyBWdWV4LlN0b3JlKHtcbiAgICBtb2R1bGVzOiB7XG4gICAgICAgIHZTdG9yZVxuICAgIH0sXG4gICAgc3RyaWN0OiB0cnVlLFxuICAgIHBsdWdpbnM6IFtdXG59KTtcbmRlc2NyaWJlKFwic2ltcGxlIGV4YW1wbGVcIiwgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICB2U3RvcmUgPSBuZXcgVnVleFN0b3JlKHsgc2NoZW1hIH0pO1xuICAgICAgICBzdG9yZSA9IG5ldyBWdWV4LlN0b3JlKHtcbiAgICAgICAgICAgIG1vZHVsZXM6IHtcbiAgICAgICAgICAgICAgICB2U3RvcmVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdHJpY3Q6IHRydWUsXG4gICAgICAgICAgICBwbHVnaW5zOiBbXVxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICB0ZXN0KFwibW9kZWxzIHByZXNlbnRcIiwgKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc3RvcmUuZ2V0dGVycy5nZXRGaWVsZCgncGV0Q29sbGVjdGlvbicpKS50b01hdGNoT2JqZWN0KFtdKTtcbiAgICAgICAgZXhwZWN0KHN0b3JlLmdldHRlcnMuZ2V0RmllbGQoJ3BldCcpKS50b0JlTnVsbCgpO1xuICAgICAgICBleHBlY3Qoc3RvcmUuZ2V0dGVycy5nZXRGaWVsZCgnc3BlY2llc0NvbGxlY3Rpb24nKSkudG9NYXRjaE9iamVjdChbXSk7XG4gICAgICAgIGV4cGVjdChzdG9yZS5nZXR0ZXJzLmdldEZpZWxkKCdzcGVjaWVzJykpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG4gICAgdGVzdChcImFkZGluZyB3b3Jrc1wiLCBkb25lID0+IHtcbiAgICAgICAgc3RvcmUuZGlzcGF0Y2goJ2NyZWF0ZScsIHtcbiAgICAgICAgICAgIHR5cGU6ICdwZXQnLFxuICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdHYXJmaWVsZCdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBleHBlY3Qoc3RvcmUuZ2V0dGVycy5nZXRGaWVsZCgncGV0Q29sbGVjdGlvbicpLmxlbmd0aCkudG9CZSgxKTtcbiAgICAgICAgICAgIGV4cGVjdChzdG9yZS5nZXR0ZXJzLmdldEZpZWxkKCdwZXQuYXR0cmlidXRlcy5uYW1lJykpLnRvQmUoXCJHYXJmaWVsZFwiKTtcbiAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgdGVzdChcInVwZGF0aW5nIHdvcmtzXCIsIGFzeW5jIGRvbmUgPT4ge1xuICAgICAgICBhd2FpdCBzdG9yZS5kaXNwYXRjaCgnY3JlYXRlJywge1xuICAgICAgICAgICAgdHlwZTogJ3BldCcsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ0dhcmZpZWxkJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgbGV0IGdhcmZpZWxkID0gY2xvbmUoc3RvcmUuZ2V0dGVycy5nZXRGaWVsZCgncGV0JykpO1xuICAgICAgICBnYXJmaWVsZC5hdHRyaWJ1dGVzLm5hbWUgPSBcIkxhc3NpZVwiO1xuICAgICAgICBhd2FpdCBzdG9yZS5kaXNwYXRjaCgndXBkYXRlJywgZ2FyZmllbGQpO1xuICAgICAgICBleHBlY3Qoc3RvcmUuZ2V0dGVycy5nZXRGaWVsZCgncGV0Q29sbGVjdGlvbicpLmxlbmd0aCkudG9CZSgxKTtcbiAgICAgICAgZXhwZWN0KHN0b3JlLmdldHRlcnMuZ2V0RmllbGQoJ3BldC5hdHRyaWJ1dGVzLm5hbWUnKSkudG9CZShcIkxhc3NpZVwiKTtcbiAgICAgICAgZG9uZSgpO1xuICAgIH0pO1xuICAgIHRlc3QoXCJkZWxldGluZyB3b3Jrc1wiLCBhc3luYyBkb25lID0+IHtcbiAgICAgICAgYXdhaXQgc3RvcmUuZGlzcGF0Y2goJ2NyZWF0ZScsIHtcbiAgICAgICAgICAgIHR5cGU6ICdwZXQnLFxuICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdHYXJmaWVsZCdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGxldCBnYXJmaWVsZCA9IGNsb25lKHN0b3JlLmdldHRlcnMuZ2V0RmllbGQoJ3BldCcpKTtcbiAgICAgICAgYXdhaXQgc3RvcmUuZGlzcGF0Y2goJ2RlbGV0ZScsIGdhcmZpZWxkKTtcbiAgICAgICAgZXhwZWN0KHN0b3JlLmdldHRlcnMuZ2V0RmllbGQoJ3BldENvbGxlY3Rpb24nKS5sZW5ndGgpLnRvQmUoMCk7XG4gICAgICAgIGV4cGVjdChzdG9yZS5nZXR0ZXJzLmdldEZpZWxkKCdwZXQnKSkudG9CZU51bGwoKTtcbiAgICAgICAgZG9uZSgpO1xuICAgIH0pO1xufSk7Il19